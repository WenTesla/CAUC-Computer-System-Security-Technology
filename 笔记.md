### 第一章
##### 1.1 网络信息安全攻击一般包含哪些主要阶段？在各个阶段，攻击者主要想实现哪些目标
1. 侦察（Reconnaissance）
2. 扫描（Scanning）
3. 获取访问（Gaining Access）
4. 维持访问（Maintaining Access）
5. 掩盖踪迹（Covering Tracks）

------


- 侦察阶段主要目标：**攻击者想方设法收集尽量多的有关被攻击目标的信息，以便为实际的攻击做好准备。**
- 扫描阶段主要目标：侦察可以获得很多有价值的信息，但对于实施攻击来说往往还不够，**对系统进行扫描可以进一步掌握有关攻击目标的更多信息。**
- 获取访问阶段主要目标：**利用侦察和扫描阶段收集到的信息，攻击者便可以尝试闯入目标系统，对目标系统进行访问。**
- 维持访问阶段主要目标：攻入一个系统终归不是一件轻而易举的事情，一旦攻入成功，**攻击者总要采取各种可能的措施，以便为下一次攻击打开方便之门**，这就是维持访问所要实现的目标，木马和后门是实现该目标的主要武器。
- 掩盖踪迹阶段主要目标：为了既能够成功地实施安全攻击，实现攻击目标，又可以逍遥法外，攻击者常常设法隐藏他们的攻击行为，以期不被发现。特别是在安装了木马后门之后，攻击者总要把控系统，以便销毁攻击痕迹，掩盖攻击行径。**(攻击者在完成攻击后，会清理自己在目标系统中的痕迹，以避免被发现和追踪。)**

##### 1.2 信息系统安全的地位和作用
- 地位：**网络安全之下，物理安全之上**；系统安全是确保信息安全的中坚力量
- 作用：主要提供**安全的操作系统和安全的数据库管理系统**，以**实现操作系统和数据库管理系统的安全运行**，包括服务器、终端/工作站等在内的计算机设备在操作系统和数据库系统层面的安全。

##### 1.3 什么是安全策略、安全模型、安全机制，它们之间存在什么样的关系？

**安全策略**：关于安全策略，国际上有多种定义。

* 安全策略是指规定一个组织为达到安全目标如何管理、保护和发布信息资源的法律、规章和条例的集合。
* 安全策略是指为达到一组安全目标而设计的规则的集合。
* 安全策略是指关于允许什么和禁止什么的规定。

**安全模型**：与安全策略相比，安全模型强调的是表现形式，它不涉及安全对策方面的内容。

* 安全模型是指拟由系统实施的安全策略的形式化表示
* 安全模型是指用更加形式化的或数学化的术语对安全策略的重新表述。
* 在访问行为中，主动发起访问操作的实体称为主体，被动接受访问操作的实体称为客体

**安全机制**：国际上对安全机制的定义也并不统一，也有多种形式
* 安全机制是指实现安全功能的逻辑或算法。
* 安全机制是指在硬件和软件中实现特定安全实施功能或安全相关功能的逻辑或算法。
* 安全机制是指实施安全策略的方法、工具或规程。

>(gpt摘的)关系：安全策略是信息系统安全的总体规划，安全模型是对安全策略的形式化描述和分析，而安全机制是实现安全策略和安全模型的具体技术手段。安全策略指导安全模型的建立和安全机制的选择，安全模型可以帮助选择和优化安全机制，而安全机制则是实现安全策略和安全模型的具体手段

##### 1.4 安全机制设计原则总体解决什么问题？八大原则分别解决什么问题
**总体解决的问题**：减少安全机制中可能存在的缺陷，进而增强安全机制的有效性

* 经济性原则：把安全机制设计得尽可能**简单和短小**，防止因机制复杂而无法处理漏洞。
* 默认拒绝原则：防止采取默认允许方案。**没有看到授权信息，就不允许访问**。
* 安全仲裁原则：**避免出现能逃过检查的访问操作**。
* 开放设计原则：**保证系统的开放性**，但不能牺牲系统的安全性，防止系统因过于封闭而影响业务的正常运行。开放设计思想有助于使安全机制接受广泛的审查，进而提高安全机制的鲁棒性。
* 特权分离原则：对特权进行细分，把一项特权细分成多项特权，分配给多个主体，**降低每个特权拥有者
的权力，从而增强系统的安全性**。
* 最小特权原则：确保**用户只能访问其所需的资源**，防止未经授权的人员获取敏感信息。
* 最少公共机制原则：**尽量减少公共机制的使用**，防止攻击者利用公共机制对系统进行攻击。
* 心理可接受原则：**考虑人为因素对系统安全的影响**。

### 第二章

如果作为客体的拥有者的用户个体可以通过设置访问控制属性来准许或拒绝对该客体的访问，那么这样的访问控制称为**自主访问控制**。

如果只有系统才能控制对客体的访问，而用户个体不能改变这种控制，那么 这样的访问控制称为**强制访问控制**。

#### 2.1 贝拉模型

如果 (Sub, Obj, r) 是当前访问，那么一定有： f (Sub) ≥ f (Obj) 其中，f 表示安全级别，≥ 表示支配关系。

在任意状态，如果 (Sub, Obj, Acc) 是当前访问，那么一定有： 

(1)若 Acc 是 r，则：f-c (Sub) ≥ f (Obj) 

(2)若 Acc 是 a，则：f (Obj) ≥ f-c (Sub) 

(3)若 Acc 是 w，则：f (Obj) = f-c (Sub) 

其中，f 表示安全级别，f-c表示当前安全级别，≥ 表示支配关系。可读 r、可写 a、可读写 w 和不可读写（可执行）e

定义：设在贝-拉模型中，实体 E1和 E2的安全级别分别为： 

level(E1) = (L1, C1)、level(E2) = (L2, C2) 用 ≥ 表示支配关系。

**那么： level(E1) ≥ level(E2) 当且仅当： L1 ≥ L2 且 C1 ⊇ C2**

##### 2.4设整数 1、2、3、4 分别表示非密、秘密、机密、绝密四种密级，符号 d1、d2、d3 分 别是财务处、科研处、教务处的标识，标签 l1、l2、l3、l4、l5 用于表示贝-拉模型中的安全级别，它们的定义如下： 

- l1 = (2, {d1})；
- l2 = (4, {d1})；
- l3 = (4, {d2})； 
- l4 = (1, {d1, d2, d3})；
- l5 = (4, {d1, d2, d3})； 

试比较安全标签 l1、l2、l3、l4、l5 之间的关系（支配关系）。  

l2支配l1，因为4>=2 且{d1}是{d1}的子集

l5支配l1，因为4>2且{d1}是{d1，d2，d3}的子集

l5支配l2，因为4>=2且{d1}是{d1，d2，d3}的子集

l5支配l3，因为4>=2且{d2}是{d1，d2，d3}的子集

l5支配l4，因为4>1且{d1，d2，d3}是{d1，d2，d3}的子集

##### 2.5根据第 4 题的定义，已知某学校下发的文件 F1、F2、F3的安全级别分别为 l1、l3、l5， 该校老师 T1、T2、T3 的当前安全级别分别为 l3、l4、l5，根据贝-拉模型，试问： A. 哪些老师可以读哪些文件？ B. 哪些老师可以写那些文件？

A:T1都不可读，T2都不可读，T3可读F1，F2，F3

B:T1可写F2，F3，T2可写F3，T3可写F3

> **不上读，不下写**

#### 2.2 毕巴模型

##### 2.8 设毕巴严格完整性模型、毕巴低水标模型、毕巴环模型对访问进行控制的强度分别 为 DS、DL、DR，请证明： DS ＞ DL ＞ DR



#### 2.3 克拉克-威尔逊模型

##### 2.11 克-威模型的实施规则是从哪几个方面进行完整性访问控制的？它的证明规则是从哪几个方面确保完整性访问控制的有效性的

克-威模型主要制定了九条规则（四条 E 规则和五条 C 规则）。
* **规则C1** 完整性验证过程必须验证所有的约束数据项在完整性验证过程运行的时候都处于有效状态。
* **规则C2** 对转换过程 的有效性进行验证，并要求安全管理员为每个 转换过程 指定它可以操作的所有 约束数据项。
* **规则E1** 系统必须实现规则 C2 中描述的关系表，对于任意的约束数据项，系统必须确保只有关系表中列出的对应 转换过程 才能对该 约束数据项 进行操作。
* **规则E2** 系统必须维护一张用户标识、转换过程 及 约束数据项 集合间的对应关系表，只有表中的用户才能执行相关的 转换过程 对相应的 约束数据项 进行操作，用户标识用 UserID 表示，关系表的格式是：
  (UserID, 转换过程i, (约束数据项a, 约束数据项b, 约束数据项c, …))
* **规则C3** 必须证明规则 E2 中的关系表满足职责分离要求。
* **规则E3** 系统必须对试图执行 转换过程 的每个用户的身份进行认证。
* **规则C4** 必须证明所有的 转换过程 都向一个只能以附加方式写的 约束数据项（日志）写入足够的信息，以便能够重现 转换过程 的操作过程。
* **规则C5** 必须证明接收 非约束数据项 输入的 转换过程 以两种方式之一处理 非约束数据项，它要么对 非约束数据项 进行有效转换，要么不做任何转换；换言之，转换过程 要么把 非约束数据项 转换为 约束数据项，要么拒绝该 非约束数据项。
* **规则E4** 只有有权给某实体（如 转换过程）作证明的主体才能修改该实体与其它实体（如约束数据项）之间的关系表，而且，有权给某实体（如 转换过程 或 约束数据项）作证明的主体不能拥有与该实体相关的执行权。

##### 2.12设 Ui是一个用户标识，TPj是一个转换过程，CDIk是一个受保护的数据项，请问克 -威模型如何判断用户 Ui是否可以通过执行 TPj来对数据项 CDIk进行操作？

用户UI通过执行TPJ对数据项CDLK进行操作，就必须由用户UI证明TPJ的 有效性或CDLK的完整性

如果用户UI有权证明TPJ的有效性，根据规则E4（必须证明所有TPJ都向一个只能以附加的方法写的CDLK写入足够的信息，以便能够重视TP的操作过程），该用户就无权执行TPJ，但已知条件说明用户UI能够执行TPJ，这是矛盾的，所以不能由用户UI证明TPJ的有效性。

同样，如果用户UI有权证明CDLK的完整性，根据规则E4，该用户就无权在CDLK上执行操作，但已知条件说明用户UI可执行TPJ在CDLK上的操作，这也是矛盾的，所以不能由用户UI证明CDLK的完整性。

##### 2.16 简要说明 DTE 模型的策略语言 DTEL 主要是从哪几个方面描述访问控制规则的？

（gpt）DTEL主要从**标签、类型、规则集、策略文件和标记等**方面描述进程对文件的访问控制规则。

##### 2.18假设采用哈希函数 h 进行数据完整性度量，如果 h 存在碰撞问题，试分析这对完整性度量结果会产生什么影响？

如果存在碰撞问题，则无法保证数据完整性，因为存在两个不同的s1，s2但是HASH（s1）和HASH（s2）相同。

##### 2.20已知一棵哈希树的叶节点数 n=2^m （m≥1），求数据项 Dk（1≤k≤n）的完整性验证路径的集合元素个数？

**m+1**

哈希树是满二叉树，每个节点都有两个子节点，哈希树的叶节点数为2^h,h为哈希树高度。
数据项 Dk（1≤k≤n）的完整性验证路径的集合元素个数为 h + 1，即完整性验证路径上包含的节点数为哈希树的高度加1

定义 2.29 

设 h 是一个哈希函数，D 是给定的数据项，i 和 j 是自然数（1≤i≤j≤n），递 归函数 f(i,j,D)的值由以下方法确定：

 **⑴ f(i,i,D) = h(Di)** 

 **⑵ f(i,j,D) = h( f(i, (i+j-1)/2, D) || f((i+j+1)/2, j, D))** 

### 第三章
##### 3.7验证一个 TPM 是否正宗的方法是检查它的背书密钥（EK）与背书证书是否匹配， 匹配则正宗，不匹配则不正宗。请问以下验证需要检查什么匹配关系？ ⑴ 验证一个平台是否拥有信任根； ⑵ 验证一对签名密钥是否属于某 TPM； ⑶ 验证关于某被度量组件的可信性的结论是否真实。

1. 提供一个凭证，把安装在平台上的 TPM 的背书密钥（EK）的公钥信息记载在凭证中，以此作为 TPM 与平台相关联的证据。这样的凭证就是平台证书。RTM、TPM 及两者间的可信路径的组合代表着一个信任根。**需要检查根证书是否与信任根的证书匹配**
2. 需要检查 TPM 的背书密钥和背书证书，以确保**签名密钥与特定 TPM 相关联**。这可以通过比较签名密钥的证书和 TPM 的背书证书来完成。
3. 需要检查被度量组件的**度量值是否与该组件的预期度量值匹配**，并且该度量值是否由可信的TPM签发。

##### 3.9 在一个可信平台上，当需要把受保护数据存放到宿主计算机硬盘中时，如何利用TPM保护这些数据的机密性和完整性

对于必须移动在TPM外的保护对象，TPM对其进行**加密**，防止内容外泄，保护了机密性。

对于从外转入TPM内的对象，TPM对其进行**完整型校验，验证了他们的完整性**，如果完整性遭到破坏，就拒绝转入。从而保护了完整性。

##### 3.11完整性度量时常用的 TPM 扩展命令可以简要地表示为： TPM2_PCR_Extend(n, data[m]) 其中 n 是 PCR 寄存器标记，data[m]是待扩展的数据列表，n 和 m 由实际情况确定。命令的功效是： for i=1 to m do PCR[n] = H(PCR[n] || data[i]) 即把数据列表中的值依次扩展到寄存器 PCR[n]中。 试分析：用一个 PCR 寄存器能否记录一个度量流的度量轨迹？为什么？

能，因为PCR[n]的值是通过将当前值和新的数据的值HASH运算后得到的。因此他能捕获度量流中所有数据的度量轨迹。

##### 3.17 TCS 层和 TSP 层的软件都提供环境管理功能，这两层环境管理的作用分别是什么

TCS主要负责管理与**TPM交互的应用程序的上下文**。负责调度应用程序对TPM的访问，以保证每个应用程序能够安全访问TPM资源。

TSP主要负责管理与**TPM相关的系统资源**。负责分配和发放系统资源。

##### 3.21 在启用了 BitLocker 机制的 Windows 操作系统中，只要在计算机引导过程中能够顺利对主密钥 VMK 进行解封装，就可以断定引导组件的完整性没有被破坏，为什么？

BitLocker机制是将系统启动分成两个阶段处理的。在第一阶段，引导组件会进行验证，以确保它没有被篡改或损坏。如果引导组件通过了验证，BitLocker会使用TPM中存储的密钥来解封装VMK密钥，从而进行第二阶段的启动。
VMK密钥是用于加密系统卷的主密钥，只有在通过验证的引导组件中才能够被解封装。因此，如果VMK密钥能够被成功解封装，说明引导组件通过了验证，没有被篡改或损坏。这样就可以断定引导组件的完整性没有被破坏。

##### 1.5 BitLocker 引导检查过程 简述

>计算机启动时，BitLocker会对引导组件进行验证，以确保其没有被篡改或损坏。如果引导组件通过了验证，BitLocker会使用TPM中存储的密钥来解封装VMK密钥。VMK解封装后，使用VMK密钥来解密系统卷，以启动操作系统。操作系统启动后，进行系统启动检查，以确保系统启动过程中没有被篡改或损坏。	

### 第四章
#### 1.1 设 P 是一个用户口令，X 是保存在操作系统认证信息库中与 P 对应的口令相关信息，请给出根据 P 生成 X 的三种算法，并分析和对比这些算法的口令保护强度（三种算法分别是明文、密文、加密算法方面）
1. 明文存储方式：将用户口令 P 明文存储在操作系统认证信息库中，口令相关信息 X 就是 P 本身。

2. 密文存储方式：将用户口令 P 通过加密算法生成密文 C，将密文 C 存储在操作系统认证信息库中，口令相关信息 X 就是 C。

3. 哈希存储方式：将用户口令 P 通过哈希算法生成摘要值 H，将摘要值 H 存储在操作系统认证信息库中，口令相关信息 X 就是 H。

>强度：明文存储方式是最不安全的，攻击者可以直接获取用户的口令，轻易地破解系统。密文存储方式相对更安全，攻击者需要获取密文并进行解密才能获取口令，但是仍然可能被攻击者轻易破解。哈希存储方式则是最为安全的，因为哈希算法具有不可逆性，攻击者无法通过哈希值推出原始口令，从而破解系统。

#### 1.2 运用非对称密码算法，网络中的两台电脑如何实现双方身份的相互确认？请给出相应的算法加以说明。
以RSA为例：
1. 生成密钥对
2. 交换密钥
3. 身份确认
4. 会话密钥协商

### 第五章
#### 5.1.1 用户访问权限的定义与表示
单个用户对文件的操作可以定义为读、写和执行三种方式，分别用 r、w 和 x 三个字符来表示。也就是说，一个用户可以对一个文件进行 r、w、x 三种操作
#### 5.1.2 用户的划分与访问控制
操作系统中的用户可以划分为属主、属组和其余等三类
>用一个由 9 个二进制比特位组成的位串来表示用户对一个文件的访问权限，其中，
左边 3 个比特位、中间 3 个比特位、右边 3 个比特位分别表示属主类、属组类、其余类用户
对文件的访问权限。
#### 5.1.3 文件权限配置
系统中部分文件的权限配置信息如下：
>rw-r-x--x usr1 grp1 ...... file1
r---w---x usr5 grp2 ...... file2
其中，配置信息的第一列是权限(分别为属主、属组和其余)，第二列是属主名，第三列是属组名，最后一列是文件名。

#### 5.2.1 进程与文件和用户的关系
设任意进程 P 请求对任意文件 F 进行访问，进程 P 的用户标识和组标识分别为 Iup
和 Igp，文件 F 的属主、属组和访问权限位串分别为 Iuf、Igf 和 S1S2S3，其中，S1、S2、S3分别
表示 9 位的访问权限位串中左、中、右三个 3 位的子位串，按照以下步骤进行判定：
⑴ 当 Iup 等于 Iuf 时，检查 S1 中是否有相应权限，如果有，则允许访问，否则，不允许
访问，结束判定；
⑵ 当 Igp 等于 Igf 时，检查 S2 中是否有相应权限，如果有，则允许访问，否则，不允许
访问，结束判定；
⑶ 检查 S3中是否有相应权限，如果有，则允许访问，否则，不允许访问。

>SETGID 是一个文件或目录的访问权限控制位之一。当一个文件或目录的 SETGID 控制位被设置时，任何执行该文件或访问该目录的用户都会成为该文件或目录所属组的成员，即其有效组ID将被设置为该文件或目录的所属组ID。这种机制被称为组ID继承。
例：
rw---s--x usr1 grp1 ...... file1
任何访问file1的用户都会以file所属组grp1的权限访问，即有效用户组变为grp1。

##### 5.3已知 Linux 操作系统实现的是“属主/属组/其余”式的自主访问控制机制，系统中部分用户组的配置信息如下： 

##### grpt：x:850:ut01,ut02,ut03,ut04 

##### grps：x:851:us01,us02,us03,us04 

##### 文件 fone 的部分权限配置信息如下： 

##### rw---xr-x ut01 grpt ...... fone 

##### 请回答以下问题： 

##### ⑴ 用户 ut01、ut02 和 us01 对文件 fone 分别拥有什么访问权限？ 

##### ⑵ 用户 ut01 是否有办法执行文件 fone？

（1）

ut01有rw

ut02有x

us01有rx

（2）有办法，因为ut01是fone文件的属主，能改变文件的权限

##### 5.6已知 Linux 操作系统中的部分用户组的配置信息如第 3 题所示，部分文件的权限配置信息如下所示：

#####  --x--x--x ut01 grpt ...... prg1 

##### --s--x--x us01 grps ...... prg2 

##### --x--s--x us02 grps ...... prg3 

##### rwxr-x--x us01 grps ...... filex 

##### 设 prg1、prg2 和 prg3 这三个可执行程序的伪代码如下： 

##### prg1： printf( “China” ); exec( “prg2” ); 

##### prg2： printf( “England” ); exec( “prg3” ); 

##### prg3： printf( “Australia” ); return;

##### 用户 ut01 执行程序 prg1 启动了进程 P，请问进程 P 在显示 China、England、Australia 时，对文件 filex 分别拥有什么访问权限？

ut01执行prg1，p有效用户ut01，有效用户组grpt，具有x权限

ut01执行prg2，p有效用户**us01**，有效用户组grpt，具有rwx权限（有效用户决定）

ut01执行prg3，p有效用户**us01**，有效用户组grps，具有rwx权限（有效用户决定）

##### 5.11如图 5.5 所示，以目录/d2 作为 eCryptfs 加密文件系统的挂载点，用以下命令把子目 录/d1 挂载到该挂载点上： mount -t ecryptfs /d1 /d2 

##### 创建空文件 F1 和 F2，使得它们的路径名分别为： F1 = /d1/d4/f3 F2 = /d2/d4/f4 分别向 F1 和 F2 中写入字符串“北京欢迎您！”，并设： F3 = /d1/d4/f4 现通过电子邮件把 F1 和 F3 发送给远端用户 U，请问用户 U 看到的与文件 F1 和 F3 对 应的内容分别是什么？

F1是明文

F3是密文

##### 5.15在 UNIX 操作系统的 syslog 审计机制中，主要的审计任务由 syslogd 守护进程承担， 它接收审计事件，产生审计信息，请问哪几类对象向它传递审计事件？请为每类对象举出一个进程或程序实例

- 系统进程
- 用户进程
- 系统内核

#### 5.6 审计信息的分析

yslog 审计服务系统的日志信息主要存放在/var/log 目录下的日志文件中，表 5.3 列出了
该目录下的一些典型的日志文件。
表 5.3 /var/log 目录下的典型日志文件
日志文件名 解释

>dmesg 内核启动日志：系统引导时，内核产生的信息。
boot.log 系统引导日志：哪些系统服务已成功启动或关闭，哪些不能成功启动或关闭。
secure 安全日志：用户登录尝试和会话的日期、时间和持续时间等方面的信息。
messages 通用日志：很多进程产生的日志保存在其中。
cron cron 日志：crond 进程的状态信息，它周期性的执行时间表中的任务。
httpd/access_log Apache 访问日志：记录向 Apache Web 服务器获取信息的请求。
maillog 电子邮件日志：记录邮件的发件人和收件人等方面的信息。
sendmail sendmail 日志：记录 sendmail 进程产生的出错信息。
mysqld.log MySQL 服务日志：记录 MySQL 数据库服务器的活动。
vsftpd.log FTP 服务日志：记录由 vsFTPd 服务进程执行的 FTP 文件传输活动。

日志文件包含日志信息，日志信息由日志记录（审计记录）组成，每个日志记录对应一
行日志信息。构成日志记录的主要内容有：

- 产生日志记录的日期和时间；
- 产生日志信息的计算机的名称；
- 产生日志信息的程序或服务的名称；
- 产生日志信息之进程的进程号；
- 日志信息正文。

### 第六章

##### 6.1 SELinux 机制赖以支撑的 SETE 模型与 DTE 模型的区别

与 DTE 模型相比，SETE 模型具有以下突出的特点：

**⑴ 类型的细分：DTE 模型把客体划分为类型，针对类型确定访问权限，SETE 模型在类型概念的基础上，增加客体类别（Class）概念，针对类型和类别确定访问权限；**
**⑵ 权限的细化：SETE 模型为客体定义了几十个类别，为每个类别定义了相应的访问权限，因此，模型中定义了大量精细的访问权限**

##### 例 6.1 请举例说明 SETE 模型有哪些常用客体类别，并举出它们的几个常见权限。 

file（普通文件）、dir（目录）、process（进程）、socket（套接字）和 filesystem（文件系统）等都是 SETE 模型中的常用客体类别。 

file 类别的常见权限有 read（读）、write（写 ）、execute（执行）、getattr（取属性）、create （创建）等等。

dir 类别的常见权限有 read（读）、write（写）、search（搜索）、rmdir（删除） 等等。

process 类别的常见权限有 signal（发信号）、transition（域切换）、fork（创建子进程）、 getattr（取属性）等等。

socket 类别的常见权限有 bind（绑定名字）、listen（侦听连接）、connect （发起连接）、accept（接受连接）等等。

filesystem 类别的常见权限有 mount（挂载）、unmount （卸载）等等。

##### 6.2 SETE模型的SEPL语言描述访问控制方法

SETE 模型通过 SEPL 语言描述访问控制策略，确定访问控制的授权方法。
SEPL 语言用 allow 规则描述访问控制授权，该规则包含以下四个元素：

⑴ **源类型**（source_type）：主体所属的域，即，域类型，或主体类型，主体通常是要实
施访问操作的进程；
⑵ **目标类型**（target_type）：由主体访问的客体的类型；
⑶ **客体类别**（object_class）：访问权限所针对的客体类别；
⑷ 访问权限（perm_list）：允许源类型对目标类型的客体类别进行的访问。

##### 6.4 在 SETE 模型中，进程为实现工作域切换必须满足哪些条件？

进程要实现从旧的工作域到新的工作域的切换，必须同时满足以下三个条件：
⑴ 进程的新的工作域必须拥有对可执行文件的类型的 entrypoint 访问权限；
⑵ 进程的旧的工作域必须拥有对入口点程序的类型的 execute 访问权限；
⑶ 进程的旧的工作域必须拥有对进程的新的工作域的 transition 访问权限。

##### 6.9 请问 Linux 系统提供 LSM 框架的目的是什么？简要说明 LSM 的基本思想。

LSM 框架是 Linux 内核支持的安全扩展方法，其**基本思想是把安全模块插接到内核中，在标准 Linux 访问控制功能的基础上对访问行为施加进一步的限制**。

**LSM框架的目的**：LSM 在 Linux 内核的系统调用代码中安插了一系列的钩子（Hook），这些钩子的安插点位于标准 Linux 的访问权限检查之后，位于访问操作实施之前。钩子的作用是挂接 LSM 的功能模块。

##### 6.10 请问 SELinux 机制的内核体系结构主要由哪几个部分构成？各个部分主要分别负责承担什么任务？

SELinux 内核体系结构由三个主要部分构成，即，安全服务器、客体管理器和访问向量缓存（AVC）等,如图 6.10 所示。

![image-20230526105342379](https://image-bed-1313520634.cos.ap-beijing.myqcloud.com/image-20230526105342379.png)

**安全服务器**：安全策略判定功能由安全服务器提供。在 SELinux 机制中，面向内核客体的安全服务器由 SELinux 的 LSM 模块构成。安全服务器使用的安全策略由一系列安全规则表示，这些规则通过策略管理接口装入到内核中。
**客体管理器**：在 LSM 体系结构中，客体管理器由 LSM 钩子表示，这些钩子分布在内核的多个子系统中，它们调用 SELinux 的 LSM 模块进行访问判定，通过允许或拒绝对内核资源的访问来实施这些访问判定的结果。
**访问向量缓存**：AVC 保存安全服务器生成的访问判定结果，供访问权限检查时使用，这样能显著提高访问许可验证的性能。同时，AVC 为 LSM 钩子提供了与 SELinux 的接口，进而，也成为内核客体管理器与安全服务器之间的接口。

##### 6.12 在 SELinux 机制的体系结构设计中，为什么需要用户空间的客体服务器？引入用户空间的安全服务器有什么好处？引入用户空间的策略管理服务器有什么好处？

在用户空间设立相应的客体管理器，用于**实施与用户空间的访问请求对应的访问判定结果**。
**用户空间的安全服务器的引入**用户策略的规则和客体类别存储在用户空间的安全服务器中，由用户空间的安全服务器进行用户空间的资源访问判定，能提高对用户空间的客体管理器的相应效率。
**用户空间的策略服务器的引入**一方面能提高安全策略管理的灵活性，另一方面能提高内核空间和用户空间的访问判定的性能。另外，策略管理服务器运行在用户空间，这有利于进一步扩充，以便接受来自网络的访问，从而实现分布式的安全策略管理。

##### 6.2.1 访问判定

访问判定是对访问请求的响应，访问判定以访问控制策略为依据，访问判定的基本思想是检查是否存在相应的访问控制规则对请求的访问进行过授权，判定的结果是访问控制策略反映的对访问操作请求的授权结论。

##### 6.2.2 访问向量（AV）

把表示判定结果的位图称为访问向量（AV，Access Vector）

##### 6.2.3 简要说明进行访问判定的基本方法。

**访问判定返回的结果包含三个相关联的AV，分别是allow 型AV、auditallow型AV和dontaudit型 AV。**
主体对客体操作前，需要根据 AV 检查操作是否可以实施，

### 第七章

##### 7.1关系数据库系统的访问控制模型与操作系统的访问控制模型主要有哪些不同？

关系型数据库的访问控制模型通常基于**用户，角色，权限**，而数据库的访问控制模型通常基于**用户，组和权限**

##### 7.6结合 SQL 语言，简要说明关系数据库系统自主访问控制中授权的发放与回收的基本方法。

GRANT用于授权用户或角色

```sql
GRANT SELECT,INSERT ON Table To user1
```

REVOKE用于回收权限

```sql
REVOKE SELECT ON Table TO user1
```

##### 7.8设用户 BOB 拥有表 EMP 的授权管理权，用户 TOM 是小组 G1 中的成员，BOB 给 G1 发放了 EMP 上的否定式 NO-SELECT 授权，给 TOM 发放了 EMP 上的肯定式 SELECT 授权。请问 TOM 能否查询 EMP 中的记录？

不能，否定大于肯定

##### 7.9设在 SeaView 系统中，用户 BOB 和 ALICE 拥有表 EMP 的授权管理权，在 T1 时刻，BOB 给用户 TOM 发放了 EMP 上的 SELECT、INSERT、UPDATE 和 DELETE 授权，在 T2 时刻，ALICE 给 TOM 发放了 EMP 上的 NULL 授权。请问： ⑴ 在 T1 时刻之后 T2 时刻之前，TOM 对 EMP 拥有什么访问权限？ ⑵ 在 T2 时刻之后，TOM 对 EMP 拥有什么访问权限？

（1）SELECT、INSERT、UPDATE 和 DELETE

（2）在 T2 时刻之后，TOM 对 EMP 拥有 NULL 的访问权限

##### 7.11什么是授权的委托管理？简要说明授权的递归回收和非递归回收的基本思想

**一个个体把拥有客体的授权管理委托传递给另外的一个个体，使得另一主体能够发送和回收客体的授权。**

递归回收是撤销某个用户以及此用户授权给他人的权限。

非递归授权是撤销某个用户或角色的权限，而不影响其他用户和角色的权限。

##### 7.12在图 7.2 中，设授权 A 表示表 EMP 上的 SELECT 授权，主体 S0 和 S1 都以相同方式给 S2 发放了授权 A，主体 S1 现执行以下操作： REVOKE SELECT ON emp FROM s1 CASCADE 请问该操作完成后，S2、S3 和 S4 是否拥有授权 A？

![image-20230526092635012](https://image-bed-1313520634.cos.ap-beijing.myqcloud.com/image-20230526092635012.png)

S2，S3，S4拥有

##### 7.14举例说明什么是基于内容的访问控制，简要说明通过视图机制实现基于内容的访问控制的基本方法

现实应用常常要求系统根据实际需要允许用户访问表中的一部分内容，而不一定是表中的全部内容

设用户 ROCKS 是职员信息表 EMP 的属主，该表的定义为： EMP：ename, job, deptno, sal, sex, age, phone, … 各字段表示的分别是姓名、岗位、部门号、薪水、性别、年龄、电话、地址，等等。 如果访问控制策略要求只允许 TOM 等用户查询不超过 30 岁的普通职员的姓名、性别、 部门号和电话信息，ROCKS 应该如何发放授权？ 

ROCKS 可以通过以下操作创建视图 YOUNG_CLERKS： 

```sql
CREATE VIEW young_clerks AS SELECT ename, sex, deptno, phone FROM emp WHERE age <= 30 AND job = ‘CLERKS’;
```

ROCKS 可通过以下操作给 TOM 发放 YOUNG_CLERKS 上的访问授权： 

```sql
GRANT SELECT ON young_clerks TO tom 
```

以上授权能满足题中访问控制策略要求。TOM 可以执行以下操作查询职员信息： 

```sql
SELECT * FROM young_clerks
```

##### 7.17简要说明利用基于角色的访问控制机制实现授权的非递归回收的基本方法

设 MANAGER 是当前会话角色，TOM 是角色 MANAGER 的成员，而且是当前会话用户，请问执行以下两个操作的效果

```sql
⑴ GRANT teller TO julia; 
⑵ GRANT teller TO julia GRANTED BY CURRENT_ROLE;
```

⑴由用户 TOM 执行，他把角色 TELLER 分配给用户 JULIA。操作⑵由角色 MANAGER 执行，它把角色 TELLER 分配给用户 JULIA

由用户 TOM 给 JULIA 分配角色与由角色 MANAGER 给 JULIA 分配角色有什么区别呢？

区别将在撤销授权时体现出来。 

如果 JULIA 中的角色 TELLER 是由用户 TOM 分配的，在撤销 TOM 中的角色 MANAGER 时，由于递归式撤销效应，JULIA 中的角色 TELLER 将被撤销。即，撤销 TOM 的授权会导致撤销 JULIA 的授权。 

如果 JULIA 中的角色 TELLER 是由角色 MANAGER 分配的，在撤销 TOM 中的角色 MANAGER 时，JULIA 中的角色 TELLER 不受影响。即，撤销 TOM 的授权对 JULIA 的授 权没有影响。

